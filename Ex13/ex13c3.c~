/*キーボードから正の整数を入力して、その整数の各桁の数の和を計算して表示するプログラムを作成しなさい。
例えば「12345」の場合は「1 + 2 + 3 + 4 + 5 = 15」のようにである。
なお、計算する整数はint型の扱える範囲（2147483647まで）とし、範囲外の数値が入力された場合は
"illegal value"というメッセージを標準エラー出力で出力して強制終了すること（シェル変数へは「8」を渡す）。 
[実行例] 
% ./a.out
1から2147483647までの整数を入力してください：12345
15
% ./a.out
1から2147483647までの整数を入力してください：2147483647
46
% ./a.out
1から2147483647までの整数を入力してください：-1
illegal value
% ./a.out
1から2147483647までの整数を入力してください：2147483648
illegal value
*/
/*----------------------------------------------------------------------------*/
#include <stdio.h>

int digsum(int);//入力された数字とその数字の桁数情報を得て、各桁数の合計を算出する
int digits(int);//入力された数字の総桁数を算出する

int main(void){
	int n;
	
	printf("1から2147483647までの整数を入力してください：");
	scanf("%d",&n);//数値の入力
	
	if(n<0 || 2147483647 < n){//範囲外の数値が入力された時の処理
		fprintf(stderr, "illegal value.\n");
		exit(8);
	}else{//正常時の処理
		digsum(n);//引数は入力された値で関数へ飛ばす
	}
	
	return 0;
}

/*-----桁数の合計-----*/
int digsum(int n){
	int k[10];//桁ごとに分割された数字が入る配列
	int i;//ループ回数カウンタ(桁数－１回)
	int keta;//桁数
	int amari;//余剰算で出した数
	int w=10,w2;//割る数。1桁大きくなるごとに10倍する
	int sum=0;//合計の算出
	
	keta = digits(n);//総桁数算出関数へ入力された数を飛ばす。返ってきた値を桁数として使用
	
	for(i=0; i<keta; i++){
		amari = n%w;//求めたい桁数以下の数字を抽出
		w2=w;
		k[i] = amari/(w2/10);//抽出した値から求めたい数値を抽出
		w *= 10;
		
		sum += k[i];//合計の算出
	}
	printf("%dの各桁数の合計は%dです。\n",n,sum);
}

/*-----桁数の算出-----*/
int digits(int n){//入力値の桁数の算出
	int keta=1;
	int y=10;
	
	while( n/y > 0){
		y *= 10;
		keta++;
	}
	return keta;
}
